apiVersion: v1
kind: Secret
metadata:
  name: influxdb-credentials
type: Opaque
data:
  {{- $secretObj := (lookup "v1" "Secret" .Release.Namespace "influxdb-credentials") | default dict }}
  {{- $secretData := (get $secretObj "data") | default dict }}

  {{- $adminPassword := (get $secretData "admin-user-password") | default (randAlphaNum 12 | b64enc) }}
  {{- $userPassword := (get $secretData "user-password") | default (randAlphaNum 12 | b64enc) }}
  {{- $readUserPassword := (get $secretData "read-user-password") | default (randAlphaNum 12 | b64enc) }}
  {{- $writeUserPassword := (get $secretData "write-user-password") | default (randAlphaNum 12 | b64enc) }}

  {{- $adminUserToken := (get $secretData "admin-user-token") | default (randAlphaNum 12 | b64enc)}}


  admin-user-token: {{ $adminUserToken | quote }}
  admin-user-password: {{ $adminPassword | quote }}
  user-password: {{ $userPassword | quote }}
  read-user-password: {{ $readUserPassword | quote }}
  write-user-password: {{ $writeUserPassword | quote }}

---
apiVersion: v1
kind: Secret
metadata:
  name: mongodb-credentials
type: Opaque
data:

  {{- $secretObj := (lookup "v1" "Secret" .Release.Namespace "mongodb-credentials") | default dict }}
  {{- $secretData := (get $secretObj "data") | default dict }}

  {{- $mongodbPasswords := (get $secretData "mongodb-passwords") | default (randAlphaNum 12 | b64enc) }}

  {{- $mongodbRootPassword := (get $secretData "mongodb-root-password") | default (randAlphaNum 12 | b64enc) }}

  {{- $mongodbMetricsPassword := (get $secretData "mongodb-metrics-password") | default (randAlphaNum 12 | b64enc) }}

  {{- $mongodbReplicaSetKey := (get $secretData "mongodb-replica-set-key") | default (randAlphaNum 12 | b64enc) }}

  mongodb-passwords: {{ $mongodbPasswords | quote }}
  mongodb-root-password: {{ $mongodbRootPassword | quote }}
  mongodb-metrics-password: {{ $mongodbMetricsPassword | quote }}
  mongodb-replica-set-key: {{ $mongodbReplicaSetKey | quote }}
  
---
apiVersion: v1
kind: Secret
metadata:
  name: rabbitmq-credentials
type: Opaque
data:
  {{- $secretObj := (lookup "v1" "Secret" .Release.Namespace "rabbitmq-credentials") | default dict }}
  {{- $secretData := (get $secretObj "data") | default dict }}

  {{- $rabbitmqPassword := (get $secretData "rabbitmq-password") | default (randAlphaNum 12 | b64enc) }}

  rabbitmq-password: {{ $rabbitmqPassword | quote }}

---
apiVersion: v1
kind: Secret
metadata:
  name: postgresql-credentials
type: Opaque
data:
  {{- $secretObj := (lookup "v1" "Secret" .Release.Namespace "postgresql-credentials") | default dict }}
  {{- $secretData := (get $secretObj "data") | default dict }}

  {{- $password := (get $secretData "password") | default (randAlphaNum 12 | b64enc) }}
   {{- $postgresPassword := (get $secretData "postgres-password") | default (randAlphaNum 12 | b64enc) }}

  password: {{ $password | quote }}
  postgres-password: {{ $postgresPassword | quote }}

---
apiVersion: v1
kind: Secret
metadata:
  name: keycloak-credentials
type: Opaque
data:
  {{- $secretObj := (lookup "v1" "Secret" .Release.Namespace "keycloak-credentials") | default dict }}
  {{- $secretData := (get $secretObj "data") | default dict }}

  {{- $password := (get $secretData "keycloak-password") | default (randAlphaNum 12 | b64enc) }}

  keycloak-password: {{ $password | quote }}